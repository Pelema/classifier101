(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();const ie="modulepreload",ce=function(e){return"/classifier101/"+e},V={},Q=function(t,s,r){if(!s||s.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(s.map(o=>{if(o=ce(o),o in V)return;V[o]=!0;const a=o.endsWith(".css"),u=a?'[rel="stylesheet"]':"";if(!!r)for(let l=n.length-1;l>=0;l--){const d=n[l];if(d.href===o&&(!a||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${u}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":ie,a||(c.as="script",c.crossOrigin=""),c.href=o,document.head.appendChild(c),a)return new Promise((l,d)=>{c.addEventListener("load",l),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())};var G=new Intl.Collator(0,{numeric:1}).compare;function X(e,t,s){return e=e.split("."),t=t.split("."),G(e[0],t[0])||G(e[1],t[1])||(t[2]=t.slice(2).join("."),s=/[.-]/.test(e[2]=e.slice(2).join(".")),s==/[.-]/.test(t[2])?G(e[2],t[2]):s?-1:1)}function k(e){if(e.startsWith("http")){const{protocol:t,host:s}=new URL(e);return s.endsWith("hf.space")?{ws_protocol:"wss",host:s,http_protocol:t}:{ws_protocol:t==="https:"?"wss":"ws",http_protocol:t,host:s}}return{ws_protocol:"wss",http_protocol:"https:",host:e}}const se=/^[^\/]*\/[^\/]*$/,ue=/.*hf\.space\/{0,1}$/;async function le(e,t){const s={};t&&(s.Authorization=`Bearer ${t}`);const r=e.trim();if(se.test(r))try{const n=await fetch(`https://huggingface.co/api/spaces/${r}/host`,{headers:s});if(n.status!==200)throw new Error("Space metadata could not be loaded.");const o=(await n.json()).host;return{space_id:e,...k(o)}}catch(n){throw new Error("Space metadata could not be loaded."+n.message)}if(ue.test(r)){const{ws_protocol:n,http_protocol:o,host:a}=k(r);return{space_id:a.replace(".hf.space",""),ws_protocol:n,http_protocol:o,host:a}}return{space_id:!1,...k(r)}}function fe(e){let t={};return e.forEach(({api_name:s},r)=>{s&&(t[s]=r)}),t}const de=/^(?=[^]*\b[dD]iscussions{0,1}\b)(?=[^]*\b[dD]isabled\b)[^]*$/;async function pe(e){try{const s=(await fetch(`https://huggingface.co/api/spaces/${e}/discussions`,{method:"HEAD"})).headers.get("x-error-message");return!(s&&de.test(s))}catch{return!1}}const ge="This application is too busy. Keep trying!",j="Connection errored out.";async function he(e,t,s){const r={"Content-Type":"application/json"};s&&(r.Authorization=`Bearer ${s}`);try{var n=await fetch(e,{method:"POST",body:JSON.stringify(t),headers:r})}catch{return[{error:j},500]}return[await n.json(),n.status]}let ne;async function _e(e,t,s){const r={};s&&(r.Authorization=`Bearer ${s}`);const n=new FormData;t.forEach(u=>{n.append("files",u)});try{var o=await fetch(`${e}/upload`,{method:"POST",body:n,headers:r})}catch{return{error:j}}return{files:await o.json()}}async function me(e,t={normalise_files:!0}){return new Promise(async s=>{const{status_callback:r,hf_token:n,normalise_files:o}=t,a={predict:ae,submit:K,view_api:H};let u=o??!0;if(typeof window>"u"||!("WebSocket"in window)){const f=await Q(()=>import("./wrapper-b7460963-69b64cfb.js"),["assets/wrapper-b7460963-69b64cfb.js","assets/__vite-browser-external-b25bb000.js"]);ne=(await Q(()=>import("./__vite-browser-external-b25bb000.js"),[])).Blob,global.WebSocket=f.WebSocket}const{ws_protocol:p,http_protocol:c,host:l,space_id:d}=await le(e,n),$=Math.random().toString(36).substring(2),re={};let h,C={},I=!1;n&&d&&(I=await ye(d,n));async function M(f){h=f,C=fe((f==null?void 0:f.dependencies)||[]);try{L=await H(h)}catch(v){console.error(`Could not get api details: ${v.message}`)}return{config:h,...a}}let L;async function oe(f){if(r&&r(f),f.status==="running")try{h=await te(`${c}//${l}`,n);const v=await M(h);s(v)}catch{r&&r({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"})}}try{h=await te(`${c}//${l}`,n);const f=await M(h);s(f)}catch{d?W(d,se.test(d)?"space_name":"subdomain",oe):r&&r({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"})}function ae(f,v,D){let i=!1,N=!1;return new Promise((w,_)=>{const q=K(f,v,D);q.on("data",S=>{i=!0,N&&q.destroy(),w(S)}).on("status",S=>{S.stage==="error"&&_(S),S.stage==="complete"&&i&&q.destroy(),S.stage==="complete"&&(N=!0)})})}function K(f,v,D){let i,N;if(typeof f=="number")i=f,N=L.unnamed_endpoints[i];else{const g=f.replace(/^\//,"");i=C[g],N=L.named_endpoints[f.trim()]}if(typeof i!="number")throw new Error("There is no endpoint matching that name of fn_index matching that number.");let w;const _=typeof f=="number"?"/predict":f;let q,S=!1;const P={};be(`${c}//${l+h.path}`,v,N,n).then(g=>{if(q={data:g||[],event_data:D,fn_index:i},Se(i,h))E({type:"status",endpoint:_,stage:"pending",queue:!1,fn_index:i,time:new Date}),he(`${c}//${l+h.path}/run${_.startsWith("/")?_:`/${_}`}`,{...q,session_hash:$},n).then(([m,y])=>{const b=u?Y(m.data,N,h.root,h.root_url):m.data;y==200?(E({type:"data",endpoint:_,fn_index:i,data:b,time:new Date}),E({type:"status",endpoint:_,fn_index:i,stage:"complete",eta:m.average_duration,queue:!1,time:new Date})):E({type:"status",stage:"error",endpoint:_,fn_index:i,message:m.error,queue:!1,time:new Date})}).catch(m=>{E({type:"status",stage:"error",message:m.message,endpoint:_,fn_index:i,queue:!1,time:new Date})});else{E({type:"status",stage:"pending",queue:!0,endpoint:_,fn_index:i,time:new Date});let m=new URL(`${p}://${l}${h.path}
						/queue/join`);I&&m.searchParams.set("__sign",I),w=new WebSocket(m),w.onclose=y=>{y.wasClean||E({type:"status",stage:"error",message:j,queue:!0,endpoint:_,fn_index:i,time:new Date})},w.onmessage=function(y){const b=JSON.parse(y.data),{type:B,status:O,data:z}=Ee(b,re[i]);if(B==="update"&&O&&!S)E({type:"status",endpoint:_,fn_index:i,time:new Date,...O}),O.stage==="error"&&w.close();else if(B==="hash"){w.send(JSON.stringify({fn_index:i,session_hash:$}));return}else B==="data"?w.send(JSON.stringify({...q,session_hash:$})):B==="complete"?S=O:B==="generating"&&E({type:"status",time:new Date,...O,stage:O==null?void 0:O.stage,queue:!0,endpoint:_,fn_index:i});z&&(E({type:"data",time:new Date,data:u?Y(z.data,N,h.root,h.root_url):z.data,endpoint:_,fn_index:i}),S&&(E({type:"status",time:new Date,...S,stage:O==null?void 0:O.stage,queue:!0,endpoint:_,fn_index:i}),w.close()))},X(h.version||"2.0.0","3.6")<0&&addEventListener("open",()=>w.send(JSON.stringify({hash:$})))}});function E(g){let y=P[g.type]||[];y==null||y.forEach(b=>b(g))}function R(g,m){const y=P;let b=y[g]||[];return y[g]=b,b==null||b.push(m),{on:R,off:T,cancel:U,destroy:F}}function T(g,m){const y=P;let b=y[g]||[];return b=b==null?void 0:b.filter(B=>B!==m),y[g]=b,{on:R,off:T,cancel:U,destroy:F}}async function U(){const g={stage:"complete",queue:!1,time:new Date};S=g,E({...g,type:"status",endpoint:_,fn_index:i}),w&&w.readyState===0?w.addEventListener("open",()=>{w.close()}):w.close();try{await fetch(`${c}//${l+h.path}/reset`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({fn_index:i,session_hash:$})})}catch{console.warn("The `/reset` endpoint could not be called. Subsequent endpoint results may be unreliable.")}}function F(){for(const g in P)P[g].forEach(m=>{T(g,m)})}return{on:R,off:T,cancel:U,destroy:F}}async function H(f){if(L)return L;const v={"Content-Type":"application/json"};n&&(v.Authorization=`Bearer ${n}`);try{let D;X(f.version||"2.0.0","3.30")<0?D=await fetch("https://gradio-space-api-fetcher-v2.hf.space/api",{method:"POST",body:JSON.stringify({serialize:!1,config:JSON.stringify(f)}),headers:v}):D=await fetch(`${f.root}/info`,{headers:v});let i=await D.json();return"api"in i&&(i=i.api),i.named_endpoints["/predict"]&&!i.unnamed_endpoints[0]&&(i.unnamed_endpoints[0]=i.named_endpoints["/predict"]),we(i,f,C)}catch{return[{error:j},500]}}})}function Y(e,t,s,r){return e.map((o,a)=>{var u,p,c,l;return((p=(u=t.returns)==null?void 0:u[a])==null?void 0:p.component)==="File"?A(o,s,r):((l=(c=t.returns)==null?void 0:c[a])==null?void 0:l.component)==="Gallery"?o.map(d=>Array.isArray(d)?[A(d[0],s,r),d[1]]:[A(d,s,r),null]):typeof o=="object"&&o.is_file?A(o,s,r):o})}function A(e,t,s){if(e==null)return null;if(typeof e=="string")return{name:"file_data",data:e};if(Array.isArray(e)){const r=[];for(const n of e)n===null?r.push(null):r.push(A(n,t,s));return r}else e.is_file&&(s?e.data="/proxy="+s+"/file="+e.name:e.data=t+"/file="+e.name);return e}function Z(e,t,s,r){switch(e.type){case"string":return"string";case"boolean":return"boolean";case"number":return"number"}if(s==="JSONSerializable"||s==="StringSerializable")return"any";if(s==="ListStringSerializable")return"string[]";if(t==="Image")return r==="parameter"?"Blob | File | Buffer":"string";if(s==="FileSerializable")return(e==null?void 0:e.type)==="array"?r==="parameter"?"(Blob | File | Buffer)[]":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}[]":r==="parameter"?"Blob | File | Buffer":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}";if(s==="GallerySerializable")return r==="parameter"?"[(Blob | File | Buffer), (string | null)][]":"[{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}, (string | null))][]"}function ee(e,t){return t==="GallerySerializable"?"array of [file, label] tuples":t==="ListStringSerializable"?"array of strings":t==="FileSerializable"?"array of files or single file":e.description}function we(e,t,s){const r={named_endpoints:{},unnamed_endpoints:{}};for(const n in e){const o=e[n];for(const a in o){const u=t.dependencies[a]?a:s[a.replace("/","")],p=o[a];r[n][a]={},r[n][a].parameters={},r[n][a].returns={},r[n][a].type=t.dependencies[u].types,r[n][a].parameters=p.parameters.map(({label:c,component:l,type:d,serializer:$})=>({label:c,component:l,type:Z(d,l,$,"parameter"),description:ee(d,$)})),r[n][a].returns=p.returns.map(({label:c,component:l,type:d,serializer:$})=>({label:c,component:l,type:Z(d,l,$,"return"),description:ee(d,$)}))}}return r}async function ye(e,t){try{return(await(await fetch(`https://huggingface.co/api/spaces/${e}/jwt`,{headers:{Authorization:`Bearer ${t}`}})).json()).token||!1}catch(s){return console.error(s),!1}}async function be(e,t,s,r){const n=await J(t,void 0,[],!0,s);return new Promise(o=>{Promise.all(n.map(async({path:a,blob:u,data:p,type:c})=>{if(u){const l=(await _e(e,[u],r)).files[0];return{path:a,file_url:l,type:c}}else return{path:a,base64:p,type:c}})).then(a=>{a.forEach(({path:u,file_url:p,base64:c,type:l})=>{if(c)x(t,c,u);else if(l==="Gallery")x(t,p,u);else if(p){const d={is_file:!0,name:`${p}`,data:null};x(t,d,u)}}),o(t)}).catch(console.log)})}function x(e,t,s){for(;s.length>1;)e=e[s.shift()];e[s.shift()]=t}async function J(e,t=void 0,s=[],r=!1,n=void 0){if(Array.isArray(e)){let o=[];return await Promise.all(e.map(async(a,u)=>{var p;let c=s.slice();c.push(u);const l=await J(e[u],r?((p=n==null?void 0:n.parameters[u])==null?void 0:p.component)||void 0:t,c,!1,n);o=o.concat(l)})),o}else if(globalThis.Buffer&&e instanceof globalThis.Buffer){const o=t==="Image";return[{path:s,blob:o?!1:new ne([e]),data:o?`${e.toString("base64")}`:!1,type:t}]}else if(e instanceof Blob||typeof window<"u"&&e instanceof File)if(t==="Image"){let o;if(typeof window<"u")o=await ve(e);else{const a=await e.arrayBuffer();o=Buffer.from(a).toString("base64")}return[{path:s,data:o,type:t}]}else return[{path:s,blob:e,type:t}];else if(typeof e=="object"){let o=[];for(let a in e)if(e.hasOwnProperty(a)){let u=s.slice();u.push(a),o=o.concat(await J(e[a],void 0,u,!1,n))}return o}else return[]}function ve(e){return new Promise((t,s)=>{const r=new FileReader;r.onloadend=()=>t(r.result),r.readAsDataURL(e)})}function Se(e,t){var s,r,n,o;return!(((r=(s=t==null?void 0:t.dependencies)==null?void 0:s[e])==null?void 0:r.queue)===null?t.enable_queue:(o=(n=t==null?void 0:t.dependencies)==null?void 0:n[e])!=null&&o.queue)||!1}async function te(e,t){const s={};if(t&&(s.Authorization=`Bearer ${t}`),typeof window<"u"&&window.gradio_config&&location.origin!=="http://localhost:9876"){const r=window.gradio_config.root,n=window.gradio_config;return n.root=e+n.root,{...n,path:r}}else if(e){let r=await fetch(`${e}/config`,{headers:s});if(r.status===200){const n=await r.json();return n.path=n.path??"",n.root=e,n}else throw new Error("Could not get config.")}throw new Error("No config or app endpoint found")}async function W(e,t,s){let r=t==="subdomain"?`https://huggingface.co/api/spaces/by-subdomain/${e}`:`https://huggingface.co/api/spaces/${e}`,n,o;try{if(n=await fetch(r),o=n.status,o!==200)throw new Error;n=await n.json()}catch{s({status:"error",load_status:"error",message:"Could not get space status",detail:"NOT_FOUND"});return}if(!n||o!==200)return;const{runtime:{stage:a},id:u}=n;switch(a){case"STOPPED":case"SLEEPING":s({status:"sleeping",load_status:"pending",message:"Space is asleep. Waking it up...",detail:a}),setTimeout(()=>{W(e,t,s)},1e3);break;case"RUNNING":case"RUNNING_BUILDING":s({status:"running",load_status:"complete",message:"",detail:a});break;case"BUILDING":s({status:"building",load_status:"pending",message:"Space is building...",detail:a}),setTimeout(()=>{W(e,t,s)},1e3);break;default:s({status:"space_error",load_status:"error",message:"This space is experiencing an issue.",detail:a,discussions_enabled:await pe(u)});break}}function Ee(e,t){switch(e.msg){case"send_data":return{type:"data"};case"send_hash":return{type:"hash"};case"queue_full":return{type:"update",status:{queue:!0,message:ge,stage:"error",code:e.code,success:e.success}};case"estimation":return{type:"update",status:{queue:!0,stage:t||"pending",code:e.code,size:e.queue_size,position:e.rank,eta:e.rank_eta,success:e.success}};case"progress":return{type:"update",status:{queue:!0,stage:"pending",code:e.code,progress_data:e.progress_data,success:e.success}};case"process_generating":return{type:"generating",status:{queue:!0,message:e.success?null:e.output.error,stage:e.success?"generating":"error",code:e.code,progress_data:e.progress_data,eta:e.average_duration},data:e.success?e.output:null};case"process_completed":return"error"in e.output?{type:"update",status:{queue:!0,message:e.output.error,stage:"error",code:e.code,success:e.success}}:{type:"complete",status:{queue:!0,message:e.success?void 0:e.output.error,stage:e.success?"complete":"error",code:e.code,progress_data:e.progress_data,eta:e.output.average_duration},data:e.success?e.output:null};case"process_starts":return{type:"update",status:{queue:!0,stage:"pending",code:e.code,size:e.rank,position:0,success:e.success}}}return{type:"none",status:{stage:"error",queue:!0}}}async function $e(e){const r=(await(await me("https://thescripterr-fastai-deploy.hf.space/")).predict("/predict",[e.result])).data[0].confidences[0].label;results.innerHTML=`<br/><img src="${e.result}" width="300"> <p>${r}</p>`}function Ne(){const e=new FileReader;e.addEventListener("load",()=>$e(e)),e.readAsDataURL(photo.files[0])}photo.addEventListener("input",Ne);
